<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <title>View Post</title>
    <style>
      * {
        outline: 1px solid red;
      }
      .postDetail_container {
        width: 1024px;
        height: 420px;
      }
      .postDetail_container h2 {
        padding: 0px;
        padding-top: 10px;
        margin: 0px;
      }
      .postDetail_container h3 {
        padding: 0px;
        padding-top: 10px;
        margin: 0px;
      }
      .thumb_nail_container {
        display: flex;
        width: 512px;
        height: 420px;
        flex-direction: row;
      }
      .thumb_nail_list {
        margin: 0;
        padding: 0;
      }
      .thumb_nail_list img {
        width: 160px;
        height: 130px;
      }
      .thumb_nail_first {
        display: flex;
        width: 170px;
        height: 140px;
        justify-content: center;
        align-items: center;
      }
      .thumb_nail_second {
        display: flex;
        width: 170px;
        height: 140px;
        justify-content: center;
        align-items: center;
      }
      .thumb_nail_third {
        display: flex;
        width: 170px;
        height: 140px;
        justify-content: center;
        align-items: center;
      }
      .thumb_nail_main {
        display: flex;
        width: 342px;
        height: 420px;
        justify-content: center;
        align-items: center;
      }
      .thumb_nail_main img {
        width: 322px;
        height: 400px;
      }
      .postDetail_container {
        display: flex;
        flex-direction: row;
      }
      .post_info_container {
        width: 502px;
        height: 410px;
        display: flex;
        flex-direction: column;
        padding-top: 10px;
        padding-left: 10px;
      }
      .post_subtitle {
        width: 412px;
        height: 120px;
        margin: 0;
        padding: 0;
        word-wrap: break-word;
      }

      .post_product_info {
        width: 412px;
        height: 30px;
        border-bottom: 2px solid gray;
      }

      .writerId {
        width: 412px;
        height: 30px;
        border-bottom: 2px solid gray;
      }
      .product_tag {
        padding: 10px;
      }

      .postDetail_container2 {
        width: 1024px;
        height: 1000px;
      }
    </style>
  </head>
  <body>
    <div class="postDetail_container">
      <div class="thumb_nail_container">
        <div class="thumb_nail_list">
          <div class="thumb_nail_first" id="imageContainer">
            <a href="#"><img src="" alt="" /></a>
          </div>
          <div class="thumb_nail_second">
            <a href="#"><img src="" alt="" /></a>
          </div>
          <div class="thumb_nail_third">
            <a href="#"><img src="" alt="" /></a>
          </div>
        </div>
        <div class="thumb_nail_main">
          <img src="" alt="" />
        </div>
      </div>
      <div class="post_info_container">
        <div class="post_subtitle">
          <h2 th:text="${post.postSubtitle}"></h2>
        </div>
        <div class="post_product_info">
          <h3>Product Info <span style="color: gray">제품정보</span></h3>
          <!-- 버튼 넣기() -->
          <div class="product_tag">
            <button>하의</button> <button>스커트</button>
          </div>
          <!-- 태그 개수에 따라 js로 처리해야함. -->
        </div>

        <!-- <div class="writerId">
          작성자ID:<span th:text="${post.postWriterId}"></span>
        </div> -->
      </div>
    </div>
    <div class="postDetail_container2">
      <div class="post_text" th:utext="${post.postText}"></div>
      <!-- <time
          datetime=""
          th:text="${#dates.format(post.postDate,'yyyy-MM-dd')}"
        ></time> -->
    </div>

    <!-- <div th:if="${post == null}">
      <p>No post found.</p>
    </div> -->

    <a href="/main">메인화면으로</a>
  </body>
  <script th:inline="javascript">
    let imageUrls = [];
    let postTextElement = document.createElement('div');
    postTextElement.innerHTML = /*[[${post.postText}]]*/ '';

    let imageEelements = postTextElement.getElementsByTagName('img');
    for (var i = 0; i < imageEelements.length; i++) {
      let imageUrl = imageEelements[i].getAttribute('src');
      imageUrls.push(imageUrl);
      // 3개까지만 넣는 로직 추가
    }
    let imageContainer = document.getElementById('imageContainer');
    for (let j = 0; j < imageUrls.length; j++) {
      let imgTag = document.createElement('img');
      imgTag.setAttribute('src', imageUrls[j]);
    }
  </script>
  <script th:inline="javascript">
    // post.postText에서 HTML 파싱하여 <img> 태그 찾기
    let postTextElements = document.createElement('div');
    postTextElements.innerHTML = /*[[${post.postText}]]*/ '';

    let imageElements = postTextElements.getElementsByTagName('img');

    // 첫 번째, 두 번째, 세 번째 썸네일 요소 찾기
    let thumbFirst = document.querySelector('.thumb_nail_first img');
    let thumbSecond = document.querySelector('.thumb_nail_second img');
    let thumbThird = document.querySelector('.thumb_nail_third img');
    let thumbMain = document.querySelector('.thumb_nail_main img');

    // 이미지가 있다면 각각의 썸네일 요소에 할당하기
    if (imageElements.length > 0 && thumbFirst) {
      thumbFirst.src = imageElements[0].src;
      if (imageElements.length > 1 && thumbSecond) {
        thumbSecond.src = imageElements[1].src;
        if (imageElements.length > 2 && thumbThird) {
          thumbThird.src = imageElements[2].src;
        }
      }
    }
    if (imageElements.length > 0 && thumbFirst) {
      thumbMain.src = imageElements[0].src;
    }

    document
      .querySelector('.thumb_nail_first img')
      .addEventListener('click', () => {
        document.querySelector('.thumb_nail_main img').src =
          imageElements[0].src;
      });

    document
      .querySelector('.thumb_nail_second img')
      .addEventListener('click', () => {
        document.querySelector('.thumb_nail_main img').src =
          imageElements[1].src;
      });

    document
      .querySelector('.thumb_nail_third img')
      .addEventListener('click', () => {
        document.querySelector('.thumb_nail_main img').src =
          imageElements[2].src;
      });
  </script>
</html>
